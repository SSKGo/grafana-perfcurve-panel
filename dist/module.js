/*! For license information please see module.js.LICENSE.txt */
define(["react","@grafana/ui","@grafana/data","d3","emotion"],(function(e,t,n,r,a){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=5)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=a},function(e,t,n){"use strict";n.r(t);var r=n(2),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function o(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function i(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,a,o=n.call(e),l=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(e){a={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return l}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}function p(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var s,f,d,m,v=n(0),y=n.n(v),g=n(4),h=n(3),x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.render=function(){var e=this.props,t=e.data,n=e.radius,r=e.xScale,a=e.yScale,o=e.color;return y.a.createElement("g",null,t.map((function(e){return y.a.createElement("circle",{r:String(n),cx:r(e[0]),cy:a(e[1]),fill:o},y.a.createElement("title",null,e[0]+", "+e[1]))})))},t}(y.a.PureComponent),b=n(1),C=Object(b.stylesFactory)((function(){return{wrapper:Object(g.css)(f||(f=p(["\n      position: relative;\n    "],["\n      position: relative;\n    "]))),svg:Object(g.css)(d||(d=p(["\n      position: absolute;\n      top: 0;\n      left: 0;\n    "],["\n      position: absolute;\n      top: 0;\n      left: 0;\n    "]))),legend:Object(g.css)(m||(m=p(["\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      padding: 10px;\n    "],["\n      position: absolute;\n      bottom: 0;\n      left: 0;\n      padding: 10px;\n    "])))}})),E=function(e){function t(t){var n=e.call(this,t)||this;return n.state=l({},t.value),n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.value,r=t.index,a=t.onChangeItem,o=t.onDelete;return y.a.createElement(b.HorizontalGroup,null,y.a.createElement(b.Label,null,"X"),y.a.createElement(b.Input,{type:"text",name:"performCurveX",defaultValue:n.performCurveX,onBlur:function(t){var o=t.currentTarget.value;e.setState((function(){return{performCurveX:o}})),a&&void 0!==r&&a(l(l({},n),{performCurveX:o}),r)}}),y.a.createElement(b.Label,null,"Y"),y.a.createElement(b.Input,{type:"text",name:"performCurveY",defaultValue:n.performCurveY,onBlur:function(t){var o=t.currentTarget.value;e.setState((function(){return{performCurveY:o}})),a&&void 0!==r&&a(l(l({},n),{performCurveY:o}),r)}}),o&&void 0!==r&&y.a.createElement(b.Tooltip,{content:"Delete this performance curve.",theme:"info"},y.a.createElement(b.Button,{variant:"destructive",icon:"trash-alt",size:"sm",onClick:function(){o(r)}},"Remove")))},t}(y.a.PureComponent),S=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChangeItem=function(e,n){var r=c(t.props.value);r[n]=e,t.props.onChange(r)},t.onAdd=function(e){var n=c(t.props.value,[e]);t.props.onChange(n)},t.onDelete=function(e){var n=c(t.props.value);n.splice(e,1),t.props.onChange(n)},t}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.value;return y.a.createElement(b.VerticalGroup,null,y.a.createElement(b.Tooltip,{content:"Add a new performance curve.",theme:"info"},y.a.createElement(b.Button,{variant:"secondary",size:"sm",icon:"plus",onClick:function(){e.onAdd({performCurveX:"",performCurveY:""})}},"Add")),t.map((function(t,n){return y.a.createElement(E,{key:n,value:t,index:n,onChangeItem:e.onChangeItem,onDelete:e.onDelete})})))},t}(y.a.PureComponent),w=function(e){function t(t){var n=e.call(this,t)||this;return n.state=l({},t.value),n}return o(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.value,r=t.index,a=t.onChangeItem,o=t.onDelete;return y.a.createElement(b.HorizontalGroup,null,y.a.createElement(b.Label,null,"Label"),y.a.createElement(b.Input,{type:"text",name:"label",defaultValue:n.label,onBlur:function(t){var o=t.currentTarget.value;e.setState((function(){return{label:o}})),a&&void 0!==r&&a(l(l({},n),{label:o}),r)}}),y.a.createElement(b.Label,null,"X"),y.a.createElement(b.Input,{type:"text",name:"xField",defaultValue:n.xField,onBlur:function(t){var o=t.currentTarget.value;e.setState((function(){return{xField:o}})),a&&void 0!==r&&a(l(l({},n),{xField:o}),r)}}),y.a.createElement(b.Label,null,"Y"),y.a.createElement(b.Input,{type:"text",name:"yField",defaultValue:n.yField,onBlur:function(t){var o=t.currentTarget.value;e.setState((function(){return{yField:o}})),a&&void 0!==r&&a(l(l({},n),{yField:o}),r)}}),y.a.createElement(b.Label,null,"Color"),y.a.createElement(b.ColorPicker,{color:n.color,onChange:function(t){e.setState((function(){return{color:t}})),a&&void 0!==r&&a(l(l({},n),{color:t}),r)}}),o&&void 0!==r&&y.a.createElement(b.Tooltip,{content:"Delete this plot.",theme:"info"},y.a.createElement(b.Button,{variant:"destructive",icon:"trash-alt",size:"sm",onClick:function(){o(r)}},"Remove")))},t}(y.a.PureComponent),O=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChangeItem=function(e,n){var r=c(t.props.value);r[n]=e,t.props.onChange(r)},t.onAdd=function(e){var n=c(t.props.value,[e]);t.props.onChange(n)},t.onDelete=function(e){var n=c(t.props.value);n.splice(e,1),t.props.onChange(n)},t}return o(t,e),t.prototype.render=function(){var e=this,t=this.props.value;return y.a.createElement(b.VerticalGroup,null,y.a.createElement(b.Tooltip,{content:"Add a new plot.",theme:"info"},y.a.createElement(b.Button,{variant:"secondary",size:"sm",icon:"plus",onClick:function(){e.onAdd({xField:"",yField:"",color:Object(r.getColorFromHexRgbOrName)("rgba(136, 136, 136, 0.6)")})}},"Add")),t.map((function(t,n){return y.a.createElement(w,{key:n,value:t,index:n,onChangeItem:e.onChangeItem,onDelete:e.onDelete})})))},t}(y.a.PureComponent);n.d(t,"plugin",(function(){return P}));var P=new r.PanelPlugin((function(e){var t,n,a=e.options,o=e.data,l=e.width,c=e.height,f=C(),d=20,m=20,v=70,E=60,S=a.xLabel,w=a.yLabel,O=a.xMax,P=a.yMax,j=a.performanceCurveData,F=[];try{for(var k=i(j.entries()),A=k.next();!A.done;A=k.next()){var L=u(A.value,2),I=L[0],V=L[1],D=V.performCurveX.split(","),T=V.performCurveY.split(",");F[I]=[];for(var _=0;_<Math.min(D.length,T.length);_++)F[I][_]={x:Number(D[_]),y:Number(T[_])}}}catch(e){t={error:e}}finally{try{A&&!A.done&&(n=k.return)&&n.call(k)}finally{if(t)throw t.error}}var M=a.pointRadius,N=[];for(_=0;_<o.series.length;_++){var B=o.series[_].name;N[_]=B||""}var X=[[]],Y=[],z=a.plotSetting,R=z.length,G=[];o.series.map((function(e){if(void 0!==e.name){var t=e.fields.find((function(e){return e.type===r.FieldType.number}));if(t){var n=Object(r.getFieldDisplayName)(t,e);t.name=n,G.push(t)}}else e.fields.map((function(e){if(e.type===r.FieldType.number){var t=e;G.push(t)}}))}));var H=function(e){var t=G.find((function(t){return t.name===z[e].xField})),n=G.find((function(t){return t.name===z[e].yField}));if(t&&n){var r=t.values.toArray(),a=n.values.toArray();X[e]=[];for(var o=0;o<r.length;o++)X[e][o]=[r[o],a[o]];Y[e]={color:z[e].color,label:z[e].label,isVisible:!0,yAxis:1}}};for(_=0;_<R;_++)H(_);var U=h.scaleLinear().domain([0,O||0]).range([E,l-m]),q=h.scaleLinear().domain([0,P||0]).range([c-v,d]),W=h.axisBottom(U).ticks(l/80),J=h.axisLeft(q).ticks(c/80),K=h.line().curve(h.curveBasis).x((function(e){return U(e.x)})).y((function(e){return q(e.y)})),Q=a.curveColor;return y.a.createElement("div",{className:Object(g.cx)(f.wrapper,Object(g.css)(s||(s=p(["\n          width: ","px;\n          height: ","px;\n        "],["\n          width: ","px;\n          height: ","px;\n        "])),l,c))},y.a.createElement("svg",{className:f.svg,width:l,height:c,xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",viewBox:"0 0 "+l+" "+c},y.a.createElement("g",{transform:"translate(0, "+(c-v)+")",ref:function(e){h.select(e).call(W)}},y.a.createElement("text",{x:(l-E-m)/2+E,y:"40","text-anchor":"middle",fill:"currentColor","font-size":"8pt"},S)),y.a.createElement("g",{transform:"translate("+E+", 0)",ref:function(e){h.select(e).call(J)}},y.a.createElement("text",{x:-(c-d-v)/2,y:"-50","text-anchor":"middle",fill:"currentColor",transform:"rotate(-90)","font-size":"8pt"},w)),y.a.createElement("g",null,U.ticks().map((function(e){return y.a.createElement("line",{stroke:"currentColor","stroke-opacity":"0.1",y1:d,y2:c-v,x1:.5+U(e),x2:.5+U(e)})}))),y.a.createElement("g",null,q.ticks().map((function(e){return y.a.createElement("line",{stroke:"currentColor","stroke-opacity":"0.1",x1:E,x2:l-m,y1:.5+q(e),y2:.5+q(e)})}))),F.map((function(e,t){return y.a.createElement("g",{id:"curve-group"},y.a.createElement("path",{fill:"none",stroke:Q,"stroke-width":"1.5",id:"curve-"+{index:t},ref:function(t){h.select(t).datum(e).attr("d",K)}}))})),y.a.createElement("g",{id:"plot-group"},X.map((function(e,t){return y.a.createElement(x,{data:e,radius:M,xScale:U,yScale:q,color:z[t].color})})))),y.a.createElement("div",{className:f.legend},y.a.createElement(b.GraphLegend,{items:Y,displayMode:b.LegendDisplayMode.List,placement:"under"})))})).setPanelOptions((function(e){return e.addTextInput({category:["Canvas Setting","Axis"],path:"xLabel",name:"xAxis Label",defaultValue:"Flowrate"}).addNumberInput({category:["Canvas Setting","Axis"],path:"xMax",name:"xAxis Max Value",defaultValue:1600}).addTextInput({category:["Canvas Setting","Axis"],path:"yLabel",name:"yAxis Label",defaultValue:"Pressure"}).addNumberInput({category:["Canvas Setting","Axis"],path:"yMax",name:"yAxis Max Value",defaultValue:4e3}).addColorPicker({category:["Canvas Setting","Performance Curve"],path:"curveColor",name:"Performance Curve Color",defaultValue:Object(r.getColorFromHexRgbOrName)("rgba(136, 136, 136, 0.6)"),settings:{allowUndefined:!0,disableNamedColors:!0,textWhenUndefined:"Not defined"}}).addCustomEditor({category:["Canvas Setting","Performance Curve"],id:"performanceCurveData",path:"performanceCurveData",name:"Performance Curve Data",description:"Input sample data points of peformance curve . Program automatically draw smooth lines.",defaultValue:[{performCurveX:"200,400,600,800,1000,1200,1400",performCurveY:"4000,3900,3600,3100,2400,1500,400"}],editor:S}).addCustomEditor({category:["Plot Setting"],id:"plotSetting",path:"plotSetting",name:"Plot Setting",description:"Set field names of X and Y axis to plot operation points. Set alias in query to set field name.",defaultValue:[{xSeries:"Field X",ySeries:"Field Y",color:Object(r.getColorFromHexRgbOrName)("rgba(136, 136, 136, 0.6)")}],editor:O}).addSelect({category:["Plot Setting"],path:"pointRadius",name:"Point Radius",defaultValue:2,settings:{options:[{label:"0.5",value:.5},{label:"1",value:1},{label:"2",value:2},{label:"3",value:3},{label:"4",value:4},{label:"5",value:5},{label:"6",value:6},{label:"7",value:7},{label:"8",value:8},{label:"9",value:9},{label:"10",value:10}]}})}))}])}));
//# sourceMappingURL=module.js.map